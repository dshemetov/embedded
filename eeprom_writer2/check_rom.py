import sys

rom = bytearray(open(sys.argv[1], "rb").read())
assert len(rom) == 32 * 1024, "Expect 32 KiB ROM"

# header fields
logo = rom[0x0104:0x0134]
cart_type = rom[0x0147]
rom_size = rom[0x0148]
hdr_sum = rom[0x014D]

# known Nintendo logo bytes (Pan Docs)
# fmt: off
LOGO = bytes([
    0xCE,0xED,0x66,0x66,0xCC,0x0D,0x00,0x0B,0x03,0x73,0x00,0x83,0x00,0x0C,0x00,0x0D,
    0x00,0x08,0x11,0x1F,0x88,0x89,0x00,0x0E,0xDC,0xCC,0x6E,0xE6,0xDD,0xDD,0xD9,0x99,
    0xBB,0xBB,0x67,0x63,0x6E,0x0E,0xEC,0xCC,0xDD,0xDC,0x99,0x9F,0xBB,0xB9,0x33,0x3E
])
# fmt: on

# header checksum per spec
x = 0
for i in range(0x0134, 0x014D):
    x = (x - rom[i] - 1) & 0xFF

print("Logo OK?      ", logo == LOGO)
print("Cart type     ", hex(cart_type), "(expect 0x00 for ROM ONLY)")
print("ROM size byte ", hex(rom_size), "(expect 0x00 for 32 KiB)")
print("Hdr cksum     ", hex(hdr_sum), "computed", hex(x), "OK?", hdr_sum == x)
